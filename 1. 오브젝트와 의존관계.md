# 오브젝트와 의존관계
스프링은 자바를 기반으로 한 기술이다. 스프링이 자바에서 가장 중요하게 가치를 두는 것은 바로 객체지향 프로그래밍이 가능한 언어라는 점이다. 자바 엔터프라이즈 
기술의 혼란 속에서 잃어버렸던 객체지향 기술의 진정한 가치를 회복시키고, 그로부터 객체지향 프로그래밍이 제공하는 폭넓은 혜택을 누릴 수 있도록 기본으로 
돌아가자는 것이 바로 스프링의 핵심 철학이다.
<hr/>

### 초난감 DAO
DAO(Data Access Object)는 DB를 사용해 데이터를 조회하거나 조작하는 기능을 전담하도록 만든 오브젝트를 말한다.

#### User
```
public class User {
  String id;
  String name;
  String password;
  
  public String getId() {
    return id;
  }
  public void setId(String id) {
    this.id = id;
  }
  public String getName() {
    return name;
  }
  public void setName(String name) {
    this.name = name;
  }
  public String getPassword() {
    return password;
  }
  public void setPassword(String password) {
    this.password = password;
  }
}
```
USERS 테이블 필드 구성

필드명 | 타입 | 설정
:------:|:------:|:-----:
Id | VARCHAR(10) | Primary Key
Name | VARCHAR(20) | Not Null
Password | VARCHAR(20) | Not Null

#### UserDao
JDBC를 이용하는 작업의 일반적인 순서
* DB 연결을 위한 Connection을 가져온다.
* SQL을 담은 Statement(또는 PreparedStatement)를 만든다.
* 만들어진 Statement를 실행한다.
* 조회의 경우 SQL 쿼리의 실행 결과를 ResultSet으로 받아서 정보를 저장할 오브젝트(여기서는 User)에 옮겨준다.
* 작업 중에 생성된 Connection, Statement, ResultSet 같은 리소스는 작업을 마친 후 반드시 닫아준다.
* JDBC API가 만들어내는 예외를 잡아서 직접 처리하거나, 메소드에 throws를 선언해서 예외가 발생하면 메소드 밖으로 던지게 한다.
<hr/>

### DAO의 분리
#### 관심사의 분리
개발자가 객체를 설계할 때 가장 염두에 둬야 할 사항은 바로 미래의 변화를 어떻게 대비할 것인가이다. 객체 지향 기술은 흔히 실세셰를 최대한 가깝게 
모델링해낼 수 있기 때문에 의미가 있다고 여겨진다. 하지만 그보다는 객체지향 기술이 만들어내는 가상의 추상세계 자체를 효과적으로 구성할 수 있고, 
이를 자유롭고 편리하게 변경, 발전, 확장시킬 수 있다는 데 더 의미가 있다. 

변화는 대체로 집중된 한 가지 관심에 대해 일어나지만 그에 따른 작업은 한 곳에 집중되지 않는 경우가 많다. 변화가 한 번에 한 가지 관심에 집중돼서 
일어난다면, 우리가 준비해야 할 일은 한 가지 관심이 한 군데에 집중되게 하는 것이다. 즉 관심이 같은 것끼리는 모으고, 관심이 다른 것은 따로 떨어져 있게 
하는 것이다.

프로그래밍의 기초 개념 중에 **관심사의 분리**라는 게 있다. 괌심이 같은 것끼리는 하나의 객체 안으로 또는 친한 객체로 모이게 하고, 관심이 다른 것은 
가능한 한 따로 떨어져서 서로 영향을 주지 않도록 분리하는 것이다.
#### 커넥션 만들기의 추출
###### UserDao의 관심사항
* 첫째는 DB와 연결을 위한 커넥션을 어떻게 가져올까라는 관심이다.
* 둘째는 사용자 등록을 위해 DB에 보낼 SQL 문장을 담을 Statement를 만들고 실행하는 것이다.
* 셋째는 작업이 끝나면 사용한 리소스인 Statement와 Connection 오브젝트를 닫아줘서 소중한 공유 리소스를 시스템에 돌려주는 것이다.

###### 중복 코드의 메소드 추출
중복된 DB 연결 코드를 getConnection() 이라는 이름의 독립적인 메소드로 만들어둔다. 각 DAO 메소드에서는 이렇게 분리한 getConnection() 메소드를 
호출해서 DB 커넥션을 가져오게 만든다.

> 여러 메소드에 중복돼서 등장하는 특정 관심사항이 담긴 코드를 별도의 메소드로 분리해냈다.<br/>

> 기능이 추가되거나 바뀐 것은 없지만 UserDao는 이전보다 훨씬 깔끔해졌고 미래의 변화에 좀 더 손쉽게 대응할 수 있는 코드가 됐다. 이런 작업을 
**리팩토링**이라고 한다. 또한 getConnection() 이라고 하는 공통의 기능을 담당하는 메소드로 중복된 코드를 뽑아내는 것을 리팩토링에서는 
**메소드 추출**기법이라고 부른다. 
#### DB 커넥션 만들기의 독립
다른 종류의 DB 사용, DB 커넥션을 가져오는데 있어 독자적으로 만든 방법을 적용하고 싶다면?

###### 상속을 통한 확장
UserDao에서 메소드의 구현 코드를 제거하고 getConnection()을 추상 메소드로 만들어 놓는다. 추상 메소드라서 메소드 코드는 없지만 메소드 자체는 존재한다.
UserDao 클래스를 상속해서 각각 서브클래스를 만들고 추상메소드를 구현하면 getConnection() 메소드를 원하는 방식으로 확장한 후에 UserDao의 기능과 함께 
사용할 수 있다.

DAO의 핵심 기능인 어떻게 데이터를 등록하고 가져올 것인가라는 관심을 담당하는 UserDao와, DB 연결 방법은 어떻게 할 것인가라는 관심을 담고있는 서브클래스가 
클래스 레벨로 구분이 되고 있다. 클래스 계층구조를 통해 두 개의 관심이 독립적으로 분리되면서 변경 작업은 한층 용이해졌다. 

> 슈퍼클래스에 기본적인 로직의 흐름을 만들고, 그 기능의 일부를 추상 메소드나 오버라이딩이 가능한 protected 메소드 등으로 만든 뒤 서브클래스에서 이런 메소드를 
필요에 맞게 구현해서 사용하도록 하는 방법을 디자인 패턴에서 **템플릿 메소드 패턴**이라고 한다. 

> UserDao의 서브클래스의 getConnection() 메소드는 어떤 Connection 클래스의 오브젝트를 어떻게 생성할 것인지를 결정하는 방법이라고도 볼 수 있다. 
이렇게 서브클래스에서 구체적인 오브젝트 생성 방법을 결정하게 하는 것을 **팩토리 메소드 패턴**이라고 부른다.

UserDao는 Connection 오브젝트가 만들어지는 방법과 내부 동작 방식에는 상관없이 자신이 필요한 기능을 Connection 인터페이스를 통해 사용하기만 할 뿐이다. 
매우 깔끔한 방식으로 관심사항을 분리해 상하위 클래스에 나눠 담도록 만든 것이다.

###### 디자인 패턴
디자인 패턴은 소프트웨어 설계 시 특정 상황에서 자주 만나는 문제를 해결하기 위해 사용할 수 있는 재사용 가능한 솔루션을 말한다. 디자인 패턴은 주로 객체지향 
설계에 관한 것이고, 대부분 객체지향적 설계 원칙을 이용해 문제를 해결한다.

###### 템플릿 메소드 패턴
변하지 않는 기능은 슈퍼클래스에 만들어두고 자주 변경되며 확장할 기능은 서브클래스에서 만들도록 한다. 슈퍼클래스에서는 미리 추상 메소드 또는 오버라이드 
가능한 메소드를 정의해두고 이를 활용해 코드의 기본 알고리즘을 담고 있는 템플릿 메소드를 만든다. 슈퍼클래스에서 디폴트 기능을 정의해두거나 비워뒀다가 
서브클래스에서 선택적으로 오버라이드할 수 있도록 만들어둔 메소드를 훅메소드라고 한다. 서브클래스에서는 추상 메소드를 구현하거나, 훅 메소드를 
오버라이드하는 방법을 이용해 기능의 일부를 확장한다.

###### 팩토리 메소드 패턴
슈퍼클래스 코드에서는 서브클래스에서 구현할 메소드를 호출해서 필요한 타입의 오브젝트를 가져와 사용한다. 이 메소드는 주로 인터페이스 타입으로 오브젝트를 
리턴하므로 서브클래스에서 정확히 어떤 클래스의 오브젝트를 만들어 리턴할지는 슈퍼클래스에서는 알지 못한다. 서브클래스는 다양한 방법으로 오브젝트를 
생성하는 메소드를 재정의할 수 있다. 이렇게 서브클래스에서 오브젝트 생성 방법과 클래스를 결정할 수 있도록 미리 정의해둔 메소드를 팩토리 메소드라고 하고, 
이 방식을 통해 오브젝트 생성 방법과 나머리 로직, 즉 슈퍼클래스의 기본 코드에서 독립시키는 방법을 팩토리 메소드 패턴이라고 한다. 

> * 이 방법은 상속을 사용했다는 단점이 있다. 자바는 클래스의 다중상속을 허용하지 않기 때문이다. <br/>
> * 또 다른 문제는 상속을 통한 상하위 클래스의 관계는 생각보다 밀접하다는 점이다. 서브 클래스는 슈퍼 클래스의 기능을 직접 사용할 수 있기 때문에 
슈퍼클래스 내부의 변경이 있을 때 모든 서브클래스를 함께 수정하거나 다시 개발해야 할 수도 있다. <br/>
> * 확장된 기능은 DB 커넥션을 생성하는 코드를 다른 DAO 클래스에 적용할 수 없다는 것도 큰 단점이다. 
<hr/>

### DAO의 확장

